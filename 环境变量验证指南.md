# 环境变量配置验证指南

## ✅ 验证步骤

### 方法1：直接访问应用测试（推荐）

1. **访问部署链接**
   ```
   https://game-soul-interactive-8mwa9cmn3-allen913950839-5794s-projects.vercel.app
   ```

2. **测试AI对话功能**
   - 选择任意游戏角色（推荐选择"亚瑟"）
   - 在聊天框输入消息，例如："你好"
   - 发送消息后观察响应

3. **判断环境变量是否配置成功**

   ✅ **配置成功的标志：**
   - 回复内容**自然流畅**，符合角色性格
   - 控制台显示：`✅ Gemini AI 回复成功`
   - 控制台显示：`📊 数据来源: gemini-api`
   - 每次回复内容都不同（非固定模板）
   
   ❌ **配置失败的标志：**
   - 回复内容是固定的模板回复
   - 控制台显示：`⚠️ API 不可用，使用模拟回复`
   - 控制台显示：`💡 降级使用模拟回复`
   - 控制台有错误：`API Key not configured`

### 方法2：检查Vercel控制台

1. **登录Vercel控制台**
   - 访问：https://vercel.com/dashboard
   - 找到项目：`game-soul-interactive`

2. **检查环境变量**
   - 点击项目 → Settings → Environment Variables
   - 确认 `GEMINI_API_KEY` 已存在
   - 确认值为：`AIzaSyBrDHxvH9MfAXLW-Jwu5huJfrjA6XwX6Sk`
   - 确认环境选择了 `Production`, `Preview`, `Development`（至少包含Production）

3. **检查部署状态**
   - 点击 Deployments 标签
   - 确认最新部署状态为 `Ready`（绿色对勾）
   - 如果配置环境变量后还未重新部署，点击最新部署 → Redeploy

### 方法3：查看控制台日志（高级）

1. **打开浏览器开发者工具**
   - Chrome/Edge: 按 `F12` 或 `Cmd+Option+I` (Mac) / `Ctrl+Shift+I` (Windows)
   - 切换到 `Console` 标签

2. **发送测试消息**
   - 在应用中发送一条消息
   - 观察控制台输出

3. **分析日志**
   ```javascript
   // 成功的日志示例：
   🤖 调用 Gemini AI...
   📤 发送请求到 API 代理...
   ✅ Gemini AI 回复成功: [AI回复内容]
   📊 数据来源: gemini-api
   
   // 失败的日志示例：
   🤖 调用 Gemini AI...
   📤 发送请求到 API 代理...
   ⚠️ API 不可用，使用模拟回复
   💡 降级使用模拟回复
   ```

## 🔧 如果验证失败，排查步骤

### 1. 环境变量未生效
**症状：** 控制台显示 `API Key not configured`

**解决方案：**
- 在Vercel控制台重新部署项目
- Settings → Environment Variables → 确认变量存在
- Deployments → 最新部署 → Redeploy

### 2. API Key 无效
**症状：** 控制台显示 Gemini API 错误 4xx

**解决方案：**
- 检查API Key是否正确
- 前往 [Google AI Studio](https://makersuite.google.com/app/apikey) 验证或重新生成
- 更新Vercel环境变量

### 3. 配额限制
**症状：** 显示 `429 Too Many Requests` 或配额错误

**解决方案：**
- 稍等片刻再测试
- 检查 [Google Cloud Console](https://console.cloud.google.com/apis/api/generativelanguage.googleapis.com/quotas) 配额使用情况

## 📊 快速验证命令

如果你能访问Vercel CLI，可以运行：

```bash
# 检查环境变量
vercel env ls

# 查看最新部署日志
vercel logs
```

## ✅ 验证成功标准

满足以下**所有条件**即为配置成功：

1. ✅ 应用可以正常访问
2. ✅ 可以发送消息并收到回复
3. ✅ 控制台显示 `gemini-api` 数据来源
4. ✅ 回复内容自然且每次不同（非模板回复）
5. ✅ 无 `API Key not configured` 错误

---

## 🎯 测试建议

建议多发送几条不同的消息来测试，例如：

```
1. "你好" → 测试基础对话
2. "我刚才赢了一局" → 测试情绪识别（应该是正面回复）
3. "队友太坑了" → 测试情绪识别（亚瑟会毒舌吐槽）
4. "教我怎么玩" → 测试角色知识
```

如果所有测试都能得到自然、符合角色性格的回复，说明环境变量配置成功！🎉
